<div class="ion-padding"></div>
<ion-content [fullscreen]="true" class="ion-padding">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Mapa</ion-title>
    </ion-toolbar>
    {{currentLocation() }} {{permission | async}}
  </ion-header>
  <ion-card style="align-self: center">
    <ion-card-header>
      <ion-card-title>Localização</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <google-map
        mapId="MAIN_MAP"
        class="align-self-center"
        height="{{mapHeight}}"
        width="{{mapWidth}}"
        [center]="center"
        [zoom]="zoom"
        (mapClick)="addMarker($event)"
      >
        @if (directionResult$ | async; as directionResults) {
        <map-directions-renderer [directions]="directionResults" />
        its loaded } @for (position of listOfSafePoints; track position) {
        <map-advanced-marker [position]="position" />
        }
        <map-advanced-marker [position]="markerPosition" />
      </google-map>
    </ion-card-content>
  </ion-card>
  <ion-card>
    <div style="text-align: center; padding: 10px">
      <ion-button (click)="addSafePoint()">Definir lugar seguro</ion-button>
      <div></div>
      <ion-button (click)="getRoute()">Ir até lugar seguro</ion-button>
    </div>
  </ion-card>

  <!-- @if (actualPermission.location === 'denied') {
    <ion-card style="align-self: center; padding: .5rem;">
      <span>Estamos com problema para pegar sua atual localização.</span>
      <ion-button
      style="margin-top: 2rem;"
        color="medium"
        fill="outline"
        expand="block"
        (click)="checkPermissions()"
        >Permitir GPS</ion-button
      >
    </ion-card>
  } -->
</ion-content>
